<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="LCZ4r">
<title>Temperature Modeling with LCZ • LCZ4r</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Open_Sans-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Montserrat-0.4.9/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Temperature Modeling with LCZ">
<meta property="og:description" content="LCZ4r">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">LCZ4r</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html" aria-label="Home">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/tutorials.html">Tutorials</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/examples.html">LCZ4r-QGIS Plugin</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ByMaxAnjos/LCZ4r/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Temperature Modeling with LCZ</h1>
                        <h4 data-toc-skip class="author">Max Anjos</h4>
            
            <h4 data-toc-skip class="date">March 15, 2025</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ByMaxAnjos/LCZ4r/blob/HEAD/vignettes/local_func_modeling.Rmd" class="external-link"><code>vignettes/local_func_modeling.Rmd</code></a></small>
      <div class="d-none name"><code>local_func_modeling.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Understanding temperature variations within urban environments is
very important for climate research, particularly when examining Urban
Heat Islands. The LCZ4r package offers functions for creating
interpolated maps and thermal anomaly analyses within Local Climate
Zones (LCZs). <code><a href="../reference/lcz_interp_map.html">lcz_interp_map()</a></code> or
<code>lcz_anomaly_map</code>functions can be applied to generate
detailed spatial representations of air temperature, allowing
researchers to analyze the influence of urban structures and land use on
local climates.</p>
<p>In this guide, we’ll demonstrate how to use the
<code><a href="../reference/lcz_interp_map.html">lcz_interp_map()</a></code> or <code>lcz_anomaly_map</code>functions
to model temperature data across Berlin’s LCZ. This will involve
creating maps at specific times, customizing spatial and temporal
resolutions, and visualizing thermal anomalies.</p>
</div>
<div class="section level2">
<h2 id="interpolating-with-lcz">Interpolating with LCZ<a class="anchor" aria-label="anchor" href="#interpolating-with-lcz"></a>
</h2>
<p>The <code><a href="../reference/lcz_interp_map.html">lcz_interp_map()</a></code> or <code><a href="../reference/lcz_anomaly_map.html">lcz_anomaly_map()</a></code>
functions are used to generate a map of interpolated air temperatures.
These functions apply interpolation techniques, like the Kriging model,
to estimate air temperatures based on LCZ classes, enabling a
spatially-resolved understanding of temperature variations. The
parameters for time frequency and data segmentation are consistent with
those used in <code><a href="../reference/lcz_ts.html">lcz_ts()</a></code> and <code><a href="../reference/lcz_anomaly.html">lcz_anomaly()</a></code>, but
two additional arguments are introduced:</p>
<ul>
<li>
<strong>sp.res</strong>: Specifies the spatial resolution of the
output map in meters. Default is 100</li>
<li>
<strong>tp.res</strong>: Defines the time frequency at which values
are averaged. Default is hour</li>
</ul>
<p>The <code><a href="../reference/lcz_interp_map.html">lcz_interp_map()</a></code> and <code><a href="../reference/lcz_anomaly_map.html">lcz_anomaly_map()</a></code>
functions generate either a single raster file or a stack of rasters.
You can visualize the resulting interpolated map using the
<code><a href="../reference/lcz_plot_interp.html">lcz_plot_interp()</a></code> function, creating a clear representation
of air temperature distributions across the selected LCZs.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get the LCZ map for your city</span></span>
<span><span class="va">lcz_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcz_get_map_euro.html">lcz_get_map_euro</a></span><span class="op">(</span>city<span class="op">=</span><span class="st">"Berlin"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load sample data from LCZ4r</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"lcz_data"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="interpolating-air-temperature">Interpolating air temperature<a class="anchor" aria-label="anchor" href="#interpolating-air-temperature"></a>
</h2>
<div class="section level3">
<h3 id="single-hour-map-interpolation">Single hour map interpolation<a class="anchor" aria-label="anchor" href="#single-hour-map-interpolation"></a>
</h3>
<p>The following example demonstrates how to generate a temperature map
for a specific date and time.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#Mapping air temperatures for 6th February 2019 at 05:00h </span></span>
<span><span class="va">my_interp_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcz_interp_map.html">lcz_interp_map</a></span><span class="op">(</span><span class="va">lcz_map</span>,</span>
<span>                                data_frame <span class="op">=</span> <span class="va">lcz_data</span>, </span>
<span>                                var <span class="op">=</span> <span class="st">"airT"</span>, station_id <span class="op">=</span> <span class="st">"station"</span>,</span>
<span>                                sp.res <span class="op">=</span> <span class="fl">100</span>, tp.res <span class="op">=</span> <span class="st">"hour"</span>,</span>
<span>                                 year <span class="op">=</span> <span class="fl">2019</span>, month <span class="op">=</span> <span class="fl">2</span>, day <span class="op">=</span> <span class="fl">6</span>, hour <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Customize the plot with titles and labels</span></span>
<span><span class="fu"><a href="../reference/lcz_plot_interp.html">lcz_plot_interp</a></span><span class="op">(</span><span class="va">my_interp_map</span>, </span>
<span>                title <span class="op">=</span> <span class="st">"LCZ - air temperatures"</span>, </span>
<span>                subtitle <span class="op">=</span> <span class="st">"Berlin - 06.02.2019 at 05:00"</span>,</span>
<span>                caption <span class="op">=</span> <span class="st">"Source: LCZ4r, 2024."</span>,</span>
<span>                fill <span class="op">=</span> <span class="st">"[ºC]"</span><span class="op">)</span></span></code></pre></div>
<p><img src="fig_local_modeling_1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="hourly-interpolation-over-a-day">Hourly Interpolation Over a Day<a class="anchor" aria-label="anchor" href="#hourly-interpolation-over-a-day"></a>
</h3>
<p>The <strong>by</strong> argument allows you to generate a sequence of
hourly temperature maps for a specific day. Here, each hour will be
represented by an individual raster layer.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Active the by argument! Mapping air temperature for each hour</span></span>
<span><span class="va">my_interp_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcz_interp_map.html">lcz_interp_map</a></span><span class="op">(</span><span class="va">lcz_map</span>,</span>
<span>                                data_frame <span class="op">=</span> <span class="va">lcz_data</span>, </span>
<span>                                var <span class="op">=</span> <span class="st">"airT"</span>, station_id <span class="op">=</span> <span class="st">"station"</span>,</span>
<span>                                sp.res <span class="op">=</span> <span class="fl">100</span>, tp.res <span class="op">=</span> <span class="st">"hour"</span>,</span>
<span>                                year <span class="op">=</span> <span class="fl">2019</span>, month <span class="op">=</span> <span class="fl">2</span>, day <span class="op">=</span> <span class="fl">6</span>,</span>
<span>                                by <span class="op">=</span> <span class="st">"hour"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Rename raster names with hour</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">my_interp_map</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">24</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/lcz_plot_interp.html">lcz_plot_interp</a></span><span class="op">(</span><span class="va">my_interp_map</span>, </span>
<span>                title <span class="op">=</span> <span class="st">"Hourly LCZ - air temperatures"</span>, </span>
<span>                subtitle <span class="op">=</span> <span class="st">"Berlin - 06.02.2019"</span>,</span>
<span>                caption <span class="op">=</span> <span class="st">"Source: LCZ4r, 2024."</span>,</span>
<span>                fill <span class="op">=</span> <span class="st">"[ºC]"</span><span class="op">)</span></span></code></pre></div>
<p><img src="fig_local_modeling_2.png" width="100%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="interpolating-thermal-anomalies">Interpolating thermal anomalies<a class="anchor" aria-label="anchor" href="#interpolating-thermal-anomalies"></a>
</h2>
<p>The <code><a href="../reference/lcz_anomaly_map.html">lcz_anomaly_map()</a></code> function can be used to highlight
temperature anomalies relative to the average conditions across LCZs.
Anomaly maps are useful in identifying areas where temperatures
significantly differ from typical values, such as heat hotspots within
urban areas.</p>
<div class="section level3">
<h3 id="single-day-map-interpolation">Single day map interpolation<a class="anchor" aria-label="anchor" href="#single-day-map-interpolation"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Generate an anomaly map for a specified day</span></span>
<span><span class="va">my_anomaly_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcz_anomaly_map.html">lcz_anomaly_map</a></span><span class="op">(</span><span class="va">lcz_map</span>,</span>
<span>                                  data_frame <span class="op">=</span> <span class="va">lcz_data</span>,</span>
<span>                                  var <span class="op">=</span> <span class="st">"airT"</span>, station_id <span class="op">=</span> <span class="st">"station"</span>,</span>
<span>                                  sp.res <span class="op">=</span> <span class="fl">100</span>, tp.res <span class="op">=</span> <span class="st">"day"</span>,</span>
<span>                                  year <span class="op">=</span> <span class="fl">2019</span>, month <span class="op">=</span> <span class="fl">2</span>, day <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plotting the thermal anomaly map</span></span>
<span><span class="fu"><a href="../reference/lcz_plot_interp.html">lcz_plot_interp</a></span><span class="op">(</span><span class="va">my_anomaly_map</span>,</span>
<span>                title <span class="op">=</span> <span class="st">"LCZ - Temperature Anomalies"</span>,</span>
<span>                subtitle <span class="op">=</span> <span class="st">"Berlin - Daily Anomalies on 06.02.2019"</span>,</span>
<span>                caption <span class="op">=</span> <span class="st">"Source: LCZ4r, 2024"</span>,</span>
<span>                fill <span class="op">=</span> <span class="st">"[Anomaly ºC]"</span>,</span>
<span>                palette <span class="op">=</span> <span class="st">"bl_yl_rd"</span></span>
<span>                <span class="op">)</span></span></code></pre></div>
<p><img src="fig_local_modeling_3.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="daytime-and-nighttime-anomalies">Daytime and nighttime anomalies<a class="anchor" aria-label="anchor" href="#daytime-and-nighttime-anomalies"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Split up anomalies into daytime and nighttime with by="daylight" </span></span>
<span><span class="va">my_anomaly_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcz_anomaly_map.html">lcz_anomaly_map</a></span><span class="op">(</span><span class="va">lcz_map</span>,</span>
<span>                                  data_frame <span class="op">=</span> <span class="va">lcz_data</span>,</span>
<span>                                  var <span class="op">=</span> <span class="st">"airT"</span>, station_id <span class="op">=</span> <span class="st">"station"</span>,</span>
<span>                                  sp.res <span class="op">=</span> <span class="fl">100</span>, tp.res <span class="op">=</span> <span class="st">"hour"</span>,</span>
<span>                                  year <span class="op">=</span> <span class="fl">2019</span>, month <span class="op">=</span> <span class="fl">2</span>, day <span class="op">=</span> <span class="fl">6</span>,</span>
<span>                                  by <span class="op">=</span> <span class="st">"daylight"</span><span class="op">)</span></span>
<span><span class="co">#Rename raster</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">my_anomaly_map</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Daytime"</span>, <span class="st">"Nighttime"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plotting the thermal anomaly map</span></span>
<span><span class="fu"><a href="../reference/lcz_plot_interp.html">lcz_plot_interp</a></span><span class="op">(</span><span class="va">my_anomaly_map</span>,</span>
<span>                title <span class="op">=</span> <span class="st">"LCZ- Temperature Anomalies"</span>,</span>
<span>                subtitle <span class="op">=</span> <span class="st">"Berlin - Diurnal Cycle of Anomalies on 06.02.2019"</span>,</span>
<span>                caption <span class="op">=</span> <span class="st">"Source: LCZ4r, 2024"</span>,</span>
<span>                fill <span class="op">=</span> <span class="st">"[ºC Anomaly]"</span>,</span>
<span>                palette <span class="op">=</span> <span class="st">"bl_yl_rd"</span>,</span>
<span>                <span class="op">)</span></span></code></pre></div>
<p><img src="fig_local_modeling_4.png" width="100%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="have-feedback-or-suggestions">Have feedback or suggestions?<a class="anchor" aria-label="anchor" href="#have-feedback-or-suggestions"></a>
</h2>
<p>Do you have an idea for improvement or did you spot a mistake? We’d
love to hear from you! Click the button below to create a new issue
(Github) and share your feedback or suggestions directly with us.</p>
<button type="button" class="btn" style="background-color: #008000; color: white; padding: .25rem .5rem; font-size: .75rem; border: none; border-radius: .25rem;">
<a href="https://github.com/ByMaxAnjos/LCZ4r/issues/new" style="text-decoration: none; color: white;" class="external-link">
Open an issue in the Github repository </a>
</button>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Max Anjos.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
